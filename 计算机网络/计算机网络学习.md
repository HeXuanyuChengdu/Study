# 计算机网络学习

## 第1章 了解web网络基础

### 1.1 使用 HTTP协议访问Web

​                              请求

客户端      \<\=\=\=\=\= \=\=\=\=\=\=\=\=\=\=  >     服务器

​			      相应

​			HTTP协议

- 客户端：通过请求获取服务器资源
- 服务器：对请求进行相应并处理
- HTTP :超文本传输协议

### 1.2 HTTP的诞生

1989年3月，HTTP诞生。

CERN(欧洲核子研究组织)提姆伯纳斯李提出了远距离共享的设想

HTTP基本理念：借助多文档之间的相互关联形成的超文本，连成可以互相参阅的万维网 ——www

构建www的技术：

- HTML：一种使用标准通用标记语言（SGML）作为标记的语言
- URL：指定文档所在地
- HTTP：文档传递协议

1990年11月，CERN成功研发了第一台web服务器和web浏览器。

不同公司的浏览器对HTML支持有细微区别，设计时需要考虑HTML兼容

1996年5月，HTTP1.0发布，该协议标准仍被广泛应用，之前的HTTP协议称为HTTP0.9

1997年1月，HTTP1.1发布，是目前最主流的HTTP协议版本

新一代HTTP2.0仍在制订中，覆盖率不高。

### 1.3 网络基础HTTP

互联网是在TCP/IP协议的基础上运行的。

HTTP协议是TCP/IP协议族的一个子集。

#### 1.3.1 TCP/IP协议族

协议：为了使不同的计算机之间实现相互通信，双方必须约定一套相同的规则来用于通信，这种规则就被称为协议。

TCP/IP协议族规定的内容包括:

- 电缆的规格
- IP地址的选定方法
- 寻找异地用户的方法
- …..

目前，一切关于与互联网相关的协议集合，被称为TCP/IP协议族。

#### 1.3.2 TCP/IP的分层管理

从功能的角度，TCP/IP协议族分为了四层，包括：

- 应用层
- 传输层
- 网络层
- 数据链路层

各层之间拥有通信的接口，除此之外，各层之间不会造成影响。

分层管理简化了设计，应用层的应用程序在设计时只需考虑本来的任务，不需要去关注对方在哪里，传输是否能送达。。。

##### 应用层

决定了向用户提供应用服务时的通信活动。

应用层协议包括（就是说开发的web程序要遵循的通信规则）：

- FTP:文件传输协议
- DNS：域名系统
- HTTP:文件传输协议
- …..

主要功能：应用层是用户能看见的部分，直接处理应用程序对通信的需求。

HTTP协议的简单工作模型：

​                                 HTTP协议

 用户输入网址   \=\=\=\=\=\=\=\=\=\=>服务器接收请求（用户要访问网址对应的网页）

​          浏览器



##### 传输层

- 主要作用：确保数据完整、有序的到达目标设备
- 主要的传输层协议：
	- TCP：传输控制协议
	- UDP：用户数据报协议

##### 网络层

主要功能：找到数据从源到达目的地的路径，这种行为被称为路由。

实现路由的核心：IP地址

##### 数据链路层

主要功能：负责在物理设备之间传输数据

实现功能的核心：MAC地址

#### 1.3.3 TCP/IP通信传输流

​                                                                       各层之间数据流动示意图

![数据在各层之间的传输过程](截图/数据在各层之间的传输过程.png)

1.  用户使用应用程序例如，浏览器，希望进行通信，于是浏览器发送符合规范的通信消息—请求
2. 在客户端中消息按照规定的形式一层层的向下传递
3. 到达服务器端后，服务器端从数据链路层开始接收消息
4. 服务器端中按照规则逐层向上传递客户端发来的消息，直到到达应用层的服务器程序
5. 当服务器业务逻辑处理完成，对客户端的响应按照同样的流程传输回客户端。

具体来说：

![数据封装模型](截图/数据封装模型.png)

1.用户在使用HTTP客户端程序时，产生了通信需求，由HTTP客户端程序生成HTTP请求，用于传输用户对服务器的请求（要服务器做什么）

2.传输层中，为了方便传输，TCP协议将HTTP请求按照一定的大小和规则，分割成一段段的报文段并在各个报文段上添加序号与端口号，之后转发给网络层。

3.TCP报文段到达网络层后，添加IP头（源IP、目标IP）转发给数据链路层

4.数据链路层添加MAC头（源MAC,目标MAC）对实际网络传输进行控制，送至目的服务器。

这种对数据的包装称为封装。



思考：

- 虽然逻辑上整个封装过程是分层次进行的，但对于这一个流程的实现都是在本地计算机上实现的。

- 应用层上，由各种HTTP客户端程序实现生成HTTP请求报文。

- 传输层上，对请求报文数据的分割，以及之后的其他层的添加MAC地址等行为，并不是由一个独立的应用程序来进行具体操作，而是由操作系统内核中的TCP/IP==协议栈==完成。

- 以liunx操作系统中发送HTTP请求举例：

	| 层次            | 逻辑上的行为                                                 | 对应的实现                                                |
	| --------------- | ------------------------------------------------------------ | --------------------------------------------------------- |
	| 应用层          | 应用程序调用socket()创建套接字，并调用send()发送数据         | net/socket.c:实现 scocket API(socket()、bind()、listen()) |
	| TCP层（传输层） | TCP将大数据拆分成报文段；TCP计算校验和，确保数据完整性；TCP维护重传机制，保证可靠传输 | net/ipv4/tcp.c:实现TCP逻辑（重传、控流）                  |
	| IP层（网络层）  | 为TCP报文添加IP头；查找路由表，确定下一跳地址                | /net/ipv4/ip_output.c处理IP数据包的发送                   |
	| 数据链路层      | 添加MAC头；调用网卡驱动，将数据转换为电信号或无线信号发送出去 | drivers/net/:网卡驱动，发送数据到物理网络                 |

1.4 与HTTP关系密切的协议：IP、TCP、DNS

- IP: